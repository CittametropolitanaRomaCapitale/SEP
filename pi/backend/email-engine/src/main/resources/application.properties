# SERVER
quarkus.http.port=8081
quarkus.http.cors=true
quarkus.http.cors.origins=*
quarkus.http.cors.methods=GET,POST,PUT,DELETE
quarkus.http.cors.headers=Content-Type,Authorization
%test.quarkus.http.test-port=8084
%test.quarkus.http.test-ssl-port=8446
%dev.quarkus.devservices.enabled=false

quarkus.application.name=email-engine
%develop.quarkus.application.name=email-engine-dev
%staging.quarkus.application.name=email-engine-staging
%prod.quarkus.application.name=email-engine-prod

quarkus.otel.enabled=false
quarkus.otel.traces.enabled=false
quarkus.otel.exporter.otlp.traces.endpoint=http://localhost:4317
quarkus.otel.exporter.otlp.traces.headers=authorization=Bearer my_secret

# Logs
quarkus.log.handler.gelf.enabled=false
%develop.quarkus.log.handler.gelf.enabled=true
%prod.quarkus.log.handler.gelf.enabled=true
%staging.quarkus.log.handler.gelf.enabled=true

quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}(%L)] (%t) %s%e%n

quarkus.http.limits.max-body-size=150M
quarkus.http.limits.max-form-attribute-size=100M

#OIDC
quarkus.oidc.auth-server-url=${KEYCLOAK_URL}
quarkus.oidc.client-id=${KEYCLOAK_CLIENT_ID:user-interface}
quarkus.oidc.credentials.secret=${KEYCLOAK_CLIENT_SECRET}
quarkus.oidc.tls.verification=none
quarkus.keycloak.policy-enforcer.enable=false

#IMAGE BUILD
quarkus.container-image.registry=\${REGISTRY\}
quarkus.container-image.group=cmrc
quarkus.container-image.name=pi-backend/email-engine
quarkus.container-image.tag=\${IMAGE_TAG:tag\}
quarkus.container-image.username=\${REGISTRY_USERNAME\}
quarkus.container-image.password=\${REGISTRY_PASSWORD\}
quarkus.container-image.insecure=true

quarkus.logging-manager.openapi.included=true
quarkus.swagger-ui.always-include=true

#@GRAPHQL
quarkus.smallrye-graphql.ui.always-include=true

#Database
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=${POSTGRES_USERNAME}
quarkus.datasource.password=${POSTGRES_PASSWORD}
quarkus.datasource.jdbc.url=jdbc:postgresql://${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DATABASE}
quarkus.datasource.jdbc.initial-size = 1
quarkus.hibernate-orm.database.generation = none
quarkus.hibernate-orm.log.sql = false
quarkus.hibernate-orm.jdbc.timezone = Europe/Rome
quarkus.hibernate-orm.packages=it.parsec326.pi.intranet.model

#Test DATABASE
%test.quarkus.datasource.db-kind=postgresql
%test.quarkus.datasource.username=${POSTGRES_USERNAME}
%test.quarkus.datasource.password=${POSTGRES_PASSWORD}
%test.quarkus.datasource.jdbc.url=jdbc:postgresql://${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DATABASE_TEST}
%test.quarkus.hibernate-orm.database.generation = none

# Kubernetes - Props
quarkus.kubernetes.replicas=1
quarkus.kubernetes.name=email-engine
quarkus.kubernetes.service-type=load-balancer
quarkus.kubernetes.ports."http".host-port=8006
quarkus.kubernetes.ports."http".container-port=8081
quarkus.kubernetes.ports.job.host-port=8000
quarkus.kubernetes.ports."job".container-port=8000
quarkus.kubernetes.resources.requests.cpu=15m
quarkus.kubernetes.resources.requests.memory=443M
quarkus.kubernetes.add-version-to-label-selectors=false
quarkus.jackson.timezone=Europe/Rome
quarkus.kubernetes.prometheus.generate-service-monitor=false

# Kubernetes - Secret
quarkus.kubernetes.image-pull-secrets=regcred
quarkus.kubernetes.env.mapping.encryption-key.from-secret=pi-prop-secret
quarkus.kubernetes.env.mapping.encryption-key.with-key=ENCRYPTION_KEY

# KUBERNETES - Env
quarkus.kubernetes.env.vars.MINIO_HOST=\${MINIO_HOST\}
quarkus.kubernetes.env.vars.MINIO_PORT=\${MINIO_PORT\}
quarkus.kubernetes.env.vars.MINIO_SECURE=\${MINIO_SECURE\}
quarkus.kubernetes.env.vars.MINIO_USERNAME=\${MINIO_USERNAME\}
quarkus.kubernetes.env.vars.MINIO_PASSWORD=\${MINIO_PASSWORD\}
quarkus.kubernetes.env.vars.POSTGRES_USERNAME=\${POSTGRES_USERNAME\}
quarkus.kubernetes.env.vars.POSTGRES_HOST=\${POSTGRES_HOST\}
quarkus.kubernetes.env.vars.POSTGRES_DATABASE=\${POSTGRES_DATABASE\}
quarkus.kubernetes.env.vars.POSTGRES_SCHEMA=\${POSTGRES_SCHEMA\}
quarkus.kubernetes.env.vars.POSTGRES_PORT=\${POSTGRES_PORT\}
quarkus.kubernetes.env.vars.SSO_URL=\${SSO_URL\}
quarkus.kubernetes.env.vars.KEYCLOAK_URL=\${KEYCLOAK_URL\}
quarkus.kubernetes.env.vars.KEYCLOAK_CLIENT_ID=\${KEYCLOAK_CLIENT_ID\}
quarkus.kubernetes.env.vars.KEYCLOAK_CLIENT_SECRET=\${KEYCLOAK_CLIENT_SECRET\}
quarkus.kubernetes.env.vars.PRODUCER_ENABLED=\${PRODUCER_ENABLED\}
quarkus.kubernetes.env.vars.CONSUMER_ENABLED=\${CONSUMER_ENABLED\}
quarkus.kubernetes.env.vars.CONSUMER_RICEVUTE_ENABLED=\${CONSUMER_RICEVUTE_ENABLED\}
quarkus.kubernetes.env.vars.ENV=\${ENV\}
quarkus.kubernetes.env.vars.TZ=\${TZ\}

quarkus.jib.jvm-entrypoint=java,-XX:+UseStringDeduplication,-Xms64m,-XX:+UseG1GC,-XX:MinHeapFreeRatio=2,-XX:MaxHeapFreeRatio=10,-XX:-ShrinkHeapInSteps,-Dcom.sun.management.jmxremote.port=9091,-Dcom.sun.management.jmxremote.rmi.port=9091,-Dcom.sun.management.jmxremote,-Djava.rmi.server.hostname=127.0.0.1,-Dcom.sun.management.jmxremote.authenticate=false,-Dcom.sun.management.jmxremote.ssl=false,-Dcom.sun.management.jmxremote.local.only=false,-jar,quarkus-run.jar
%dev.quarkus.jib.jvm-entrypoint=java,-XX:+UseStringDeduplication,-XX:+PrintGCDetails,-Xms64m,-XX:+UseG1GC,-XX:MinHeapFreeRatio=2,-XX:MaxHeapFreeRatio=10,-XX:-ShrinkHeapInSteps,-Dcom.sun.management.jmxremote.port=9093,-Dcom.sun.management.jmxremote.rmi.port=9093,-Dcom.sun.management.jmxremote,-Djava.rmi.server.hostname=127.0.0.1,-Dcom.sun.management.jmxremote.authenticate=false,-Dcom.sun.management.jmxremote.ssl=false,-Dcom.sun.management.jmxremote.local.only=false,-jar,quarkus-run.jar
%release.quarkus.jib.jvm-entrypoint=java,-XX:+UseStringDeduplication,-Xms64m,-XX:+UseG1GC,-XX:MinHeapFreeRatio=2,-XX:MaxHeapFreeRatio=10,-XX:-ShrinkHeapInSteps,-Dcom.sun.management.jmxremote.port=9091,-Dcom.sun.management.jmxremote.rmi.port=9091,-Dcom.sun.management.jmxremote,-Djava.rmi.server.hostname=127.0.0.1,-Dcom.sun.management.jmxremote.authenticate=false,-Dcom.sun.management.jmxremote.ssl=false,-Dcom.sun.management.jmxremote.local.only=false,-jar,quarkus-run.jar

quarkus.jib.ports=8080,9091
%dev.quarkus.jib.ports=8081,9093
quarkus.jib.base-jvm-image=amazoncorretto:17.0.10-al2023

crypto.encryptionKey=${ENCRYPTION_KEY}

# Web Socket configuration
quarkus.websocket.dispatch-to-worker=true

# JobRunr configuration
quarkus.jobrunr.dashboard.enabled=true
quarkus.jobrunr.job-scheduler.enabled=true
quarkus.jobrunr.background-job-server.enabled=true

# Job Schedule
producer.enabled=${PRODUCER_ENABLED:false}
consumer.enabled=${CONSUMER_ENABLED:false}
consumer.ricevute.enabled=${CONSUMER_RICEVUTE_ENABLED:false}
notifiche.enabled=${NOTIFICHE_ENABLED:false}
pec_peo.enabled=${PEC_PEO_ENABLED:false}
